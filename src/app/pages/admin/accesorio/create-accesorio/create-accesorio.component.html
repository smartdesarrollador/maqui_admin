<div class="container mx-auto px-4 py-8">
  <div class="max-w-2xl mx-auto">
    <div class="bg-white rounded-lg shadow-md p-6">
      <h2 class="text-2xl font-bold mb-6">Crear Nuevo Accesorio</h2>

      @if (error) {
      <div
        class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6"
        role="alert"
      >
        <p>{{ error }}</p>
      </div>
      }

      <form
        [formGroup]="accesorioForm"
        (ngSubmit)="onSubmit()"
        class="space-y-6"
      >
        <!-- Nombre -->
        <div>
          <label for="nombre" class="block text-sm font-medium text-gray-700">
            Nombre
          </label>
          <input
            type="text"
            id="nombre"
            formControlName="nombre"
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
            [class.border-red-500]="
              hasError('nombre', 'required') || hasError('nombre', 'maxlength')
            "
          />
          @if (hasError('nombre', 'required')) {
          <p class="mt-1 text-sm text-red-600">El nombre es requerido</p>
          } @if (hasError('nombre', 'maxlength')) {
          <p class="mt-1 text-sm text-red-600">
            El nombre no puede exceder 255 caracteres
          </p>
          }
        </div>

        <!-- Tipo -->
        <div>
          <label for="tipo" class="block text-sm font-medium text-gray-700">
            Tipo
          </label>
          <input
            type="text"
            id="tipo"
            formControlName="tipo"
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
            [class.border-red-500]="
              hasError('tipo', 'required') || hasError('tipo', 'maxlength')
            "
          />
          @if (hasError('tipo', 'required')) {
          <p class="mt-1 text-sm text-red-600">El tipo es requerido</p>
          }
        </div>

        <!-- Precio -->
        <div>
          <label for="precio" class="block text-sm font-medium text-gray-700">
            Precio
          </label>
          <input
            type="number"
            id="precio"
            formControlName="precio"
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
            [class.border-red-500]="
              hasError('precio', 'required') || hasError('precio', 'min')
            "
          />
          @if (hasError('precio', 'required')) {
          <p class="mt-1 text-sm text-red-600">El precio es requerido</p>
          } @if (hasError('precio', 'min')) {
          <p class="mt-1 text-sm text-red-600">El precio debe ser mayor a 0</p>
          }
        </div>

        <!-- Stock -->
        <div>
          <label for="stock" class="block text-sm font-medium text-gray-700">
            Stock
          </label>
          <input
            type="number"
            id="stock"
            formControlName="stock"
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
            [class.border-red-500]="
              hasError('stock', 'required') || hasError('stock', 'min')
            "
          />
          @if (hasError('stock', 'required')) {
          <p class="mt-1 text-sm text-red-600">El stock es requerido</p>
          } @if (hasError('stock', 'min')) {
          <p class="mt-1 text-sm text-red-600">
            El stock debe ser mayor o igual a 0
          </p>
          }
        </div>

        <!-- Descripción -->
        <div>
          <label
            for="descripcion"
            class="block text-sm font-medium text-gray-700"
          >
            Descripción
          </label>
          <textarea
            id="descripcion"
            formControlName="descripcion"
            rows="4"
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
            [class.border-red-500]="hasError('descripcion', 'required')"
          ></textarea>
          @if (hasError('descripcion', 'required')) {
          <p class="mt-1 text-sm text-red-600">La descripción es requerida</p>
          }
        </div>

        <!-- Tipo de Accesorio -->
        <div>
          <label
            for="tipo_accesorio_id"
            class="block text-sm font-medium text-gray-700"
          >
            Tipo de Accesorio
          </label>
          <select
            id="tipo_accesorio_id"
            formControlName="tipo_accesorio_id"
            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
            [class.border-red-500]="hasError('tipo_accesorio_id', 'required')"
          >
            <option value="">Seleccione un tipo</option>
            @for (tipo of tiposAccesorios; track tipo.id_tipo_accesorio) {
            <option [value]="tipo.id_tipo_accesorio">{{ tipo.nombre }}</option>
            }
          </select>
          @if (hasError('tipo_accesorio_id', 'required')) {
          <p class="mt-1 text-sm text-red-600">
            El tipo de accesorio es requerido
          </p>
          }
        </div>

        <!-- Imagen -->
        <div>
          <label for="imagen" class="block text-sm font-medium text-gray-700">
            Imagen
          </label>
          <input
            type="file"
            id="imagen"
            accept="image/*"
            (change)="onFileSelected($event)"
            class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"
          />
          @if (imagePreview) {
          <div class="mt-2">
            <img
              [src]="imagePreview"
              alt="Vista previa"
              class="h-32 w-32 object-cover rounded-lg"
            />
          </div>
          }
        </div>

        <!-- Botones -->
        <div class="flex justify-end space-x-4">
          <button
            type="button"
            routerLink="/admin/accesorios"
            class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
          >
            Cancelar
          </button>
          <button
            type="submit"
            [disabled]="loading || !accesorioForm.valid"
            class="px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"
          >
            @if (loading) {
            <span>Guardando...</span>
            } @else {
            <span>Guardar</span>
            }
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
