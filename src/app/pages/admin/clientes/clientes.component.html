<div class="p-6">
  <!-- Encabezado y Buscador -->
  <div class="mb-6">
    <h1 class="text-2xl font-bold text-gray-800 mb-4">Gestión de Clientes</h1>
    <div class="relative">
      <input
        type="text"
        [ngModel]="searchTerm"
        (input)="onSearch($event)"
        placeholder="Buscar clientes..."
        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
      />
      <div
        *ngIf="loading"
        class="absolute right-3 top-2 animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"
      ></div>
    </div>
  </div>

  <!-- Tabla de Clientes -->
  <div class="overflow-x-auto bg-white rounded-lg shadow">
    <table class="min-w-full table-auto">
      <thead>
        <tr class="bg-gray-100">
          <th
            *ngFor="
              let header of [
                { field: 'nombre', label: 'Nombre' },
                { field: 'apellido', label: 'Apellido' },
                { field: 'email', label: 'Email' },
                { field: 'telefono', label: 'Teléfono' }
              ]
            "
            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-200"
            (click)="toggleOrder(header.field)"
          >
            <div class="flex items-center space-x-1">
              <span>{{ header.label }}</span>
              @if (orderBy === header.field) {
              <span class="text-blue-500">
                {{ orderDirection === "asc" ? "↑" : "↓" }}
              </span>
              }
            </div>
          </th>
          <th
            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
          >
            Acciones
          </th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y divide-gray-200">
        @for (cliente of clientes; track cliente.id_cliente) {
        <tr class="hover:bg-gray-50">
          <td class="px-6 py-4 whitespace-nowrap">{{ cliente.nombre }}</td>
          <td class="px-6 py-4 whitespace-nowrap">{{ cliente.apellido }}</td>
          <td class="px-6 py-4 whitespace-nowrap">{{ cliente.email }}</td>
          <td class="px-6 py-4 whitespace-nowrap">{{ cliente.telefono }}</td>
          <td
            class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"
          >
            <button
              class="text-blue-600 hover:text-blue-900 mr-3"
              title="Editar"
            >
              ✏️
            </button>
            <button class="text-red-600 hover:text-red-900" title="Eliminar">
              🗑️
            </button>
          </td>
        </tr>
        } @empty {
        <tr>
          <td colspan="5" class="px-6 py-4 text-center text-gray-500">
            No se encontraron clientes
          </td>
        </tr>
        }
      </tbody>
    </table>
  </div>

  <!-- Paginación -->
  @if (lastPage > 1) {
  <div class="flex justify-center mt-4 space-x-2">
    <button
      (click)="onPageChange(currentPage - 1)"
      [disabled]="currentPage === 1"
      class="px-4 py-2 border rounded-lg"
      [class.bg-gray-100]="currentPage === 1"
      [class.hover:bg-gray-200]="currentPage !== 1"
      [class.cursor-not-allowed]="currentPage === 1"
    >
      Anterior
    </button>

    @for (page of getPages(); track page) {
    <button
      (click)="onPageChange(page)"
      class="px-4 py-2 border rounded-lg"
      [class.bg-blue-500]="currentPage === page"
      [class.text-white]="currentPage === page"
      [class.hover:bg-gray-200]="currentPage !== page"
    >
      {{ page }}
    </button>
    }

    <button
      (click)="onPageChange(currentPage + 1)"
      [disabled]="currentPage === lastPage"
      class="px-4 py-2 border rounded-lg"
      [class.bg-gray-100]="currentPage === lastPage"
      [class.hover:bg-gray-200]="currentPage !== lastPage"
      [class.cursor-not-allowed]="currentPage === lastPage"
    >
      Siguiente
    </button>
  </div>
  }
</div>
