<div class="container mx-auto px-4 py-8">
  <div class="bg-white rounded-lg shadow-lg p-6">
    <!-- Encabezado -->
    <div class="mb-8">
      <h2 class="text-2xl font-bold text-gray-800">Crear Nuevo Archivo</h2>
    </div>

    <!-- Mensajes de estado -->
    @if (mensaje) {
    <div
      [class]="
        'p-4 mb-4 rounded-lg ' +
        (tipoMensaje === 'success'
          ? 'bg-green-100 text-green-700'
          : 'bg-red-100 text-red-700')
      "
      role="alert"
    >
      {{ mensaje }}
    </div>
    }

    <!-- Formulario -->
    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="space-y-6">
      <!-- Selector de archivo -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">
          Archivo *
        </label>
        <input
          type="file"
          (change)="onFileChange($event)"
          class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500"
          [class.border-red-500]="
            form.get('file')?.invalid && form.get('file')?.touched
          "
        />
        @if (form.get('file')?.invalid && form.get('file')?.touched) {
        <p class="mt-1 text-sm text-red-600">El archivo es requerido</p>
        }
      </div>

      <!-- Preview de imagen -->
      @if (previewUrl) {
      <div class="aspect-video bg-gray-100 rounded-lg overflow-hidden">
        <img
          [src]="previewUrl"
          alt="Preview"
          class="w-full h-full object-contain"
        />
      </div>
      }

      <!-- Título -->
      <div>
        <label for="title" class="block text-sm font-medium text-gray-700 mb-2">
          Título *
        </label>
        <input
          type="text"
          id="title"
          formControlName="title"
          class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500"
          [class.border-red-500]="
            form.get('title')?.invalid && form.get('title')?.touched
          "
        />
        @if (form.get('title')?.invalid && form.get('title')?.touched) {
        <p class="mt-1 text-sm text-red-600">El título es requerido</p>
        }
      </div>

      <!-- Descripción -->
      <div>
        <label
          for="description"
          class="block text-sm font-medium text-gray-700 mb-2"
        >
          Descripción
        </label>
        <textarea
          id="description"
          formControlName="description"
          rows="3"
          class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500"
        ></textarea>
      </div>

      <!-- Texto alternativo -->
      <div>
        <label
          for="alt_text"
          class="block text-sm font-medium text-gray-700 mb-2"
        >
          Texto alternativo
        </label>
        <input
          type="text"
          id="alt_text"
          formControlName="alt_text"
          class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500"
        />
      </div>

      <!-- Categoría -->
      <div>
        <label
          for="category_id"
          class="block text-sm font-medium text-gray-700 mb-2"
        >
          Categoría
        </label>
        <select
          id="category_id"
          formControlName="category_id"
          class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500"
        >
          <option [ngValue]="null">Seleccione una categoría</option>
          @for (categoria of categorias; track categoria.id) {
          <option [value]="categoria.id">{{ categoria.name }}</option>
          }
        </select>
      </div>

      <!-- Orden -->
      <div>
        <label
          for="sort_order"
          class="block text-sm font-medium text-gray-700 mb-2"
        >
          Orden
        </label>
        <input
          type="number"
          id="sort_order"
          formControlName="sort_order"
          class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500"
        />
      </div>

      <!-- Es público -->
      <div class="flex items-center">
        <input
          type="checkbox"
          id="is_public"
          formControlName="is_public"
          class="h-4 w-4 text-red-600 focus:ring-red-500 border-gray-300 rounded"
        />
        <label for="is_public" class="ml-2 block text-sm text-gray-700">
          Es público
        </label>
      </div>

      <!-- Botones -->
      <div class="flex justify-end space-x-4">
        <button
          type="button"
          (click)="router.navigate(['/admin/medios-files'])"
          class="px-4 py-2 border rounded-lg hover:bg-gray-50 transition-colors"
        >
          Cancelar
        </button>
        <button
          type="submit"
          [disabled]="form.invalid || cargando"
          class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
        >
          @if (cargando) {
          <span class="inline-block animate-spin mr-2">⌛</span>
          } Guardar
        </button>
      </div>
    </form>
  </div>
</div>
